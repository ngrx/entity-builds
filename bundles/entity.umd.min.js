/**
 * @license NgRx 9.0.0
 * (c) 2015-2018 Brandon Roberts, Mike Ryan, Rob Wormald, Victor Savkin
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@ngrx/store"),require("@angular/core")):"function"==typeof define&&define.amd?define("@ngrx/entity",["exports","tslib","@ngrx/store","@angular/core"],t):t(((e=e||self).ngrx=e.ngrx||{},e.ngrx.entity={}),e.tslib,e.ngrx.store,e.ng.core)}(this,(function(e,t,n,i){"use strict";var r;function s(e){return function n(i,s){var o={ids:t.__spread(s.ids),entities:t.__assign({},s.entities)},u=e(i,o);return u===r.Both?Object.assign({},s,o):u===r.EntitiesOnly?t.__assign(t.__assign({},s),{entities:o.entities}):s}}function o(e,t){var n=t(e);return i.isDevMode()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",e,"The `selectId` implementation:",t.toString()),n}function u(e){function n(t,n){var i=o(t,e);return i in n.entities?r.None:(n.ids.push(i),n.entities[i]=t,r.Both)}function i(e,i){var s,o,u=!1;try{for(var a=t.__values(e),c=a.next();!c.done;c=a.next())u=n(c.value,i)!==r.None||u}catch(e){s={error:e}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(s)throw s.error}}return u?r.Both:r.None}function u(e,t){return t.ids=[],t.entities={},i(e,t),r.Both}function a(e,t){var n=(e instanceof Array?e:t.ids.filter((function(n){return e(t.entities[n])}))).filter((function(e){return e in t.entities})).map((function(e){return delete t.entities[e]})).length>0;return n&&(t.ids=t.ids.filter((function(e){return e in t.entities}))),n?r.Both:r.None}function c(t,n){var i={};return(t=t.filter((function(e){return e.id in n.entities}))).length>0?t.filter((function(t){return function r(t,n,i){var r=Object.assign({},i.entities[n.id],n.changes),s=o(r,e),u=s!==n.id;return u&&(t[n.id]=s,delete i.entities[n.id]),i.entities[s]=r,u}(i,t,n)})).length>0?(n.ids=n.ids.map((function(e){return i[e]||e})),r.Both):r.EntitiesOnly:r.None}function l(n,s){var u,a,l=[],d=[];try{for(var f=t.__values(n),h=f.next();!h.done;h=f.next()){var v=h.value,p=o(v,e);p in s.entities?d.push({id:p,changes:v}):l.push(v)}}catch(e){u={error:e}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(u)throw u.error}}var y=c(d,s),g=i(l,s);switch(!0){case g===r.None&&y===r.None:return r.None;case g===r.Both||y===r.Both:return r.Both;default:return r.EntitiesOnly}}return{removeAll:function d(e){return Object.assign({},e,{ids:[],entities:{}})},addOne:s(n),addMany:s(i),addAll:s(u),setAll:s(u),setOne:s((function f(t,n){var i=o(t,e);return i in n.entities?(n.entities[i]=t,r.EntitiesOnly):(n.ids.push(i),n.entities[i]=t,r.Both)})),updateOne:s((function h(e,t){return c([e],t)})),updateMany:s(c),upsertOne:s((function v(e,t){return l([e],t)})),upsertMany:s(l),removeOne:s((function p(e,t){return a([e],t)})),removeMany:s(a),map:s((function y(e,t){return c(t.ids.reduce((function(n,i){var r=e(t.entities[i]);return r!==t.entities[i]&&n.push({id:i,changes:r}),n}),[]).filter((function(e){return e.id in t.entities})),t)}))}}!function(e){e[e.EntitiesOnly=0]="EntitiesOnly",e[e.Both=1]="Both",e[e.None=2]="None"}(r||(r={})),e.Dictionary=function a(){},e.createEntityAdapter=function c(e){void 0===e&&(e={});var i=t.__assign({sortComparer:!1,selectId:function(e){return e.id}},e),a=i.selectId,c=i.sortComparer,l=function d(){return{getInitialState:function e(t){return void 0===t&&(t={}),Object.assign({ids:[],entities:{}},t)}}}(),f=function h(){return{getSelectors:function e(t){var i=function(e){return e.ids},r=function(e){return e.entities},s=n.createSelector(i,r,(function(e,t){return e.map((function(e){return t[e]}))})),o=n.createSelector(i,(function(e){return e.length}));return t?{selectIds:n.createSelector(t,i),selectEntities:n.createSelector(t,r),selectAll:n.createSelector(t,s),selectTotal:n.createSelector(t,o)}:{selectIds:i,selectEntities:r,selectAll:s,selectTotal:o}}}}(),v=c?function p(e,n){var i=u(e);function a(e,t){return c([e],t)}function c(t,n){var i=t.filter((function(t){return!(o(t,e)in n.entities)}));return 0===i.length?r.None:(h(i,n),r.Both)}function l(e,t){return t.entities={},t.ids=[],c(e,t),r.Both}function d(t,n){var i=[],s=t.filter((function(t){return function r(t,n,i){if(!(n.id in i.entities))return!1;var r=Object.assign({},i.entities[n.id],n.changes),s=o(r,e);return delete i.entities[n.id],t.push(r),s!==n.id}(i,t,n)})).length>0;if(0===i.length)return r.None;var u=n.ids,a=[];return n.ids=n.ids.filter((function(e,t){return e in n.entities||(a.push(t),!1)})),h(i,n),!s&&a.every((function(e){return n.ids[e]===u[e]}))?r.EntitiesOnly:r.Both}function f(n,i){var s,u,a=[],l=[];try{for(var f=t.__values(n),h=f.next();!h.done;h=f.next()){var v=h.value,p=o(v,e);p in i.entities?l.push({id:p,changes:v}):a.push(v)}}catch(e){s={error:e}}finally{try{h&&!h.done&&(u=f.return)&&u.call(f)}finally{if(s)throw s.error}}var y=d(l,i),g=c(a,i);switch(!0){case g===r.None&&y===r.None:return r.None;case g===r.Both||y===r.Both:return r.Both;default:return r.EntitiesOnly}}function h(t,i){t.sort(n);for(var r=[],s=0,u=0;s<t.length&&u<i.ids.length;){var a=t[s],c=o(a,e),l=i.ids[u];n(a,i.entities[l])<=0?(r.push(c),s++):(r.push(l),u++)}i.ids=r.concat(s<t.length?t.slice(s).map(e):i.ids.slice(u)),t.forEach((function(t,n){i.entities[e(t)]=t}))}return{removeOne:i.removeOne,removeMany:i.removeMany,removeAll:i.removeAll,addOne:s(a),updateOne:s((function v(e,t){return d([e],t)})),upsertOne:s((function p(e,t){return f([e],t)})),addAll:s(l),setAll:s(l),setOne:s((function y(t,n){var i=o(t,e);return i in n.entities?(n.ids=n.ids.filter((function(e){return e!==i})),h([t],n),r.Both):a(t,n)})),addMany:s(c),updateMany:s(d),upsertMany:s(f),map:s((function g(e,t){return d(t.ids.reduce((function(n,i){var r=e(t.entities[i]);return r!==t.entities[i]&&n.push({id:i,changes:r}),n}),[]),t)}))}}(a,c):u(a);return t.__assign(t.__assign(t.__assign({selectId:a,sortComparer:c},l),f),v)},Object.defineProperty(e,"__esModule",{value:!0})}));