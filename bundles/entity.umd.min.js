!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ngrx/store")):"function"==typeof define&&define.amd?define("@ngrx/entity",["exports","@ngrx/store"],t):t((e.ngrx=e.ngrx||{},e.ngrx.entity={}),e.ngrx.store)}(this,function(e,t){"use strict";function n(e){return function(t,n){var i={ids:n.ids.slice(),entities:Object.assign({},n.entities)},r=e(t,i);return r===o.Both?Object.assign({},n,i):r===o.EntitiesOnly?Object.assign({},n,{entities:i.entities}):n}}function i(e){function t(t,n){var i=e(t);return i in n.entities?o.None:(n.ids.push(i),n.entities[i]=t,o.Both)}function i(e,n){for(var i=!1,r=0,s=e;r<s.length;r++){i=t(s[r],n)!==o.None||i}return i?o.Both:o.None}function r(e,t){var n=e.filter(function(e){return e in t.entities}).map(function(e){return delete t.entities[e]}).length>0;return n&&(t.ids=t.ids.filter(function(e){return e in t.entities})),n?o.Both:o.None}function s(t,n){var i={};if((t=t.filter(function(e){return e.id in n.entities})).length>0){return t.filter(function(t){return function(t,n,i){var r=i.entities[n.id],s=Object.assign({},r,n.changes),o=e(s),u=o!==n.id;return u&&(t[n.id]=o,delete i.entities[n.id]),i.entities[o]=s,u}(i,t,n)}).length>0?(n.ids=n.ids.map(function(e){return i[e]||e}),o.Both):o.EntitiesOnly}return o.None}function u(e,t){for(var n=[],r=[],u=0,c=e;u<c.length;u++){var a=c[u];a.id in t.entities?r.push(a):n.push(Object.assign({},a.changes,{id:a.id}))}var d=s(r,t),l=i(n,t);switch(!0){case l===o.None&&d===o.None:return o.None;case l===o.Both||d===o.Both:return o.Both;default:return o.EntitiesOnly}}return{removeAll:function(e){return Object.assign({},e,{ids:[],entities:{}})},addOne:n(t),addMany:n(i),addAll:n(function(e,t){return t.ids=[],t.entities={},i(e,t),o.Both}),updateOne:n(function(e,t){return s([e],t)}),updateMany:n(s),upsertOne:n(function(e,t){return u([e],t)}),upsertMany:n(u),removeOne:n(function(e,t){return r([e],t)}),removeMany:n(r)}}function r(e,t){function r(t,n){var i=t.filter(function(t){return!(e(t)in n.entities)});return 0===i.length?o.None:(c(i,n),o.Both)}function s(t,n){var i=[],r=t.filter(function(t){return function(t,n,i){if(!(n.id in i.entities))return!1;var r=i.entities[n.id],s=Object.assign({},r,n.changes),o=e(s);return delete i.entities[n.id],t.push(s),o!==n.id}(i,t,n)}).length>0;if(0===i.length)return o.None;var s=n.ids,u=[];return n.ids=n.ids.filter(function(e,t){return e in n.entities||(u.push(t),!1)}),c(i,n),!r&&u.every(function(e){return n.ids[e]===s[e]})?o.EntitiesOnly:o.Both}function u(e,t){for(var n=[],i=[],u=0,c=e;u<c.length;u++){var a=c[u];a.id in t.entities?i.push(a):n.push(Object.assign({},a.changes,{id:a.id}))}var d=s(i,t),l=r(n,t);switch(!0){case l===o.None&&d===o.None:return o.None;case l===o.Both||d===o.Both:return o.Both;default:return o.EntitiesOnly}}function c(n,i){n.sort(t);for(var r=[],s=0,o=0;s<n.length&&o<i.ids.length;){var u=n[s],c=e(u),a=i.ids[o],d=i.entities[a];t(u,d)<=0?(r.push(c),s++):(r.push(a),o++)}s<n.length?i.ids=r.concat(n.slice(s).map(e)):i.ids=r.concat(i.ids.slice(o)),n.forEach(function(t,n){i.entities[e(t)]=t})}var a=i(e);return{removeOne:a.removeOne,removeMany:a.removeMany,removeAll:a.removeAll,addOne:n(function(e,t){return r([e],t)}),updateOne:n(function(e,t){return s([e],t)}),upsertOne:n(function(e,t){return u([e],t)}),addAll:n(function(e,t){return t.entities={},t.ids=[],r(e,t),o.Both}),addMany:n(r),updateMany:n(s),upsertMany:n(u)}}function s(e){void 0===e&&(e={});var n=Object.assign({sortComparer:!1,selectId:function(e){return e.id}},e),s=n.selectId,o=n.sortComparer,u={getInitialState:function(e){return void 0===e&&(e={}),Object.assign({ids:[],entities:{}},e)}},c={getSelectors:function(e){var n=function(e){return e.ids},i=function(e){return e.entities},r=t.createSelector(n,i,function(e,t){return e.map(function(e){return t[e]})}),s=t.createSelector(n,function(e){return e.length});return e?{selectIds:t.createSelector(e,n),selectEntities:t.createSelector(e,i),selectAll:t.createSelector(e,r),selectTotal:t.createSelector(e,s)}:{selectIds:n,selectEntities:i,selectAll:r,selectTotal:s}}},a=o?r(s,o):i(s);return Object.assign({selectId:s,sortComparer:o},u,c,a)}var o={EntitiesOnly:0,Both:1,None:2};o[o.EntitiesOnly]="EntitiesOnly",o[o.Both]="Both",o[o.None]="None",e.createEntityAdapter=s,Object.defineProperty(e,"__esModule",{value:!0})});